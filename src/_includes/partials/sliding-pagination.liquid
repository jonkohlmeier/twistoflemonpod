{%- comment -%}
Sliding Pagination Component

Parameters (from pagination object):
- pagination.pageNumber: Current page (0-indexed)
- pagination.href.previous: URL to previous page
- pagination.href.next: URL to next page
- pagination.href.first: URL to first page
- pagination.pages: Array of all page data

Usage:
{% include "partials/sliding-pagination.liquid", pagination: pagination %}
{%- endcomment -%}

{%- assign currentPage = pagination.pageNumber | plus: 1 -%}
{%- assign totalPages = pagination.pages.size -%}

{%- if totalPages > 1 -%}
<nav class="sliding-pagination" aria-label="Pagination" role="navigation">
  {%- comment -%} Previous button {%- endcomment -%}
  {%- if pagination.href.previous -%}
    <a href="{{ pagination.href.previous }}" class="pagination-arrow" rel="prev" aria-label="Go to previous page">
      <span aria-hidden="true">←</span>
      <span class="sr-only">Previous</span>
    </a>
  {%- else -%}
    <span class="pagination-arrow pagination-arrow-disabled" aria-hidden="true">←</span>
  {%- endif -%}

  <div class="pagination-numbers">
    {%- comment -%} Calculate sliding window boundaries {%- endcomment -%}
    {%- assign startWindow = currentPage | minus: 2 -%}
    {%- if startWindow < 1 -%}
      {%- assign startWindow = 1 -%}
    {%- endif -%}

    {%- assign endWindow = currentPage | plus: 2 -%}
    {%- if endWindow > totalPages -%}
      {%- assign endWindow = totalPages -%}
    {%- endif -%}

    {%- comment -%} Show all pages in the window {%- endcomment -%}
    {%- for pageNum in (startWindow..endWindow) -%}
      {%- comment -%} Show ellipsis before current page range if gap from start {%- endcomment -%}
      {%- if pageNum == startWindow and startWindow > 1 -%}
        {%- if startWindow > 2 -%}
          <span class="pagination-ellipsis" aria-hidden="true">…</span>
        {%- endif -%}
      {%- endif -%}

      {%- comment -%} Show page number {%- endcomment -%}
      {%- if pageNum == currentPage -%}
        <span class="pagination-number pagination-current" aria-current="page">{{ pageNum }}</span>
      {%- else -%}
        {%- assign pageIndex = pageNum | minus: 1 -%}
        {%- if pageNum == 1 -%}
          <a href="/" class="pagination-number" aria-label="Go to page {{ pageNum }}">{{ pageNum }}</a>
        {%- else -%}
          <a href="/{{ pageIndex }}/" class="pagination-number" aria-label="Go to page {{ pageNum }}">{{ pageNum }}</a>
        {%- endif -%}
      {%- endif -%}

      {%- comment -%} Show ellipsis after current page range if gap to end {%- endcomment -%}
      {%- if pageNum == endWindow and endWindow < totalPages -%}
        {%- assign nextPage = endWindow | plus: 1 -%}
        {%- if nextPage < totalPages -%}
          <span class="pagination-ellipsis" aria-hidden="true">…</span>
        {%- endif -%}
      {%- endif -%}
    {%- endfor -%}
  </div>

  {%- comment -%} Next button {%- endcomment -%}
  {%- if pagination.href.next -%}
    <a href="{{ pagination.href.next }}" class="pagination-arrow" rel="next" aria-label="Go to next page">
      <span aria-hidden="true">→</span>
      <span class="sr-only">Next</span>
    </a>
  {%- else -%}
    <span class="pagination-arrow pagination-arrow-disabled" aria-hidden="true">→</span>
  {%- endif -%}
</nav>
{%- endif -%}
