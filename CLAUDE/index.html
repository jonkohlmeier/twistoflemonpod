<h1 id="life-with-a-twist-of-lemon---development-guide" tabindex="-1">Life with a Twist of Lemon - Development Guide</h1>
<h2 id="project-overview" tabindex="-1">Project Overview</h2>
<p>This is the source code for the &quot;Life with a Twist of Lemon&quot; podcast website, hosted at <a href="https://twistoflemonpod.com/">https://twistoflemonpod.com/</a>. The site features 172 podcast episodes with full audio player support, category/tag organization, and a podcast-compatible RSS feed.</p>
<p><strong>Hosts:</strong> Jon Kohlmeier &amp; Stan Lemon</p>
<p><strong>Topics:</strong> Technology, finance, life, craftsmanship, theology, and everything else with a twist of lemon</p>
<h2 id="technology-stack" tabindex="-1">Technology Stack</h2>
<h3 id="core-framework" tabindex="-1">Core Framework</h3>
<ul>
<li><strong>Eleventy (11ty) 3.x</strong>: Static site generator chosen for simplicity and performance</li>
<li><strong>Node.js 22.x</strong>: Runtime environment (see <code>.nvmrc</code>)</li>
<li><strong>Liquid Templates</strong>: Primary templating engine for layouts and includes</li>
</ul>
<h3 id="key-dependencies" tabindex="-1">Key Dependencies</h3>
<ul>
<li><code>@11ty/eleventy-plugin-rss</code>: RSS feed generation with podcast support</li>
<li><code>@11ty/eleventy-plugin-syntaxhighlight</code>: Code syntax highlighting</li>
<li><code>@11ty/eleventy-img</code>: Image optimization</li>
<li><code>plyr</code>: Audio player for podcast episodes</li>
<li><code>luxon</code>: Date/time formatting and manipulation</li>
<li><code>markdown-it</code>: Markdown processing with anchor support</li>
<li><code>gray-matter</code>: YAML frontmatter parsing (for scripts)</li>
</ul>
<h3 id="development-tools" tabindex="-1">Development Tools</h3>
<ul>
<li><code>prettier</code>: Code formatting</li>
<li>Custom test suite: Build validation and content validation</li>
</ul>
<h2 id="architecture" tabindex="-1">Architecture</h2>
<h3 id="content-structure" tabindex="-1">Content Structure</h3>
<pre><code>content/blog/YYYY-MM-DD/slug.md
</code></pre>
<p>Each episode is a Markdown file with YAML frontmatter containing:</p>
<ul>
<li><code>title</code>: Episode title</li>
<li><code>slug</code>: URL slug (optional, auto-generated from title)</li>
<li><code>episode</code>: Episode number</li>
<li><code>date</code>: ISO 8601 date string</li>
<li><code>categories</code>: Array of categories</li>
<li><code>tags</code>: Array of tags</li>
<li><code>enclosure</code>: Podcast audio file metadata
<ul>
<li><code>url</code>: S3 URL to MP3 file</li>
<li><code>length</code>: File size in bytes</li>
<li><code>type</code>: MIME type (audio/mpeg)</li>
</ul>
</li>
</ul>
<h3 id="site-structure" tabindex="-1">Site Structure</h3>
<pre><code>src/
├── _data/           # Global site data
├── _includes/       # Layouts and partials
│   ├── layouts/     # Page templates
│   └── partials/    # Reusable components
├── css/             # Stylesheets
├── images/          # Static images
├── feed.liquid      # RSS/Podcast feed template
├── sitemap.liquid   # XML sitemap
├── categories.liquid # Category archive pages
└── tags.liquid      # Tag archive pages

content/blog/        # All episode markdown files
index.liquid         # Homepage with pagination
scripts/             # Utility scripts for maintenance
tests/               # Test suite
</code></pre>
<h3 id="build-output" tabindex="-1">Build Output</h3>
<ul>
<li>Output directory: <code>_site/</code></li>
<li>Build time: ~0.4 seconds for 283 pages</li>
<li>Pages generated:
<ul>
<li>172 episode pages</li>
<li>17 pagination pages</li>
<li>15 category pages</li>
<li>88 tag pages</li>
<li>Feed, sitemap, and index</li>
</ul>
</li>
</ul>
<h2 id="development-workflow" tabindex="-1">Development Workflow</h2>
<h3 id="best-practices" tabindex="-1">Best Practices</h3>
<p><strong>CRITICAL: Always work in small, iterative phases</strong></p>
<ol>
<li><strong>Break Down Work</strong>: Divide any task into small, logical phases</li>
<li><strong>Test First</strong>: Run <code>npm test</code> before making changes to establish baseline</li>
<li><strong>Make Changes</strong>: Implement one phase at a time</li>
<li><strong>Test Again</strong>: Run <code>npm test</code> after each phase</li>
<li><strong>Build</strong>: Run <code>npm run build</code> to verify site generation</li>
<li><strong>Commit</strong>: Create a git commit for each working phase</li>
<li><strong>Repeat</strong>: Move to the next phase</li>
</ol>
<h3 id="commit-guidelines" tabindex="-1">Commit Guidelines</h3>
<p>Each commit should:</p>
<ul>
<li>Represent a complete, working unit of change</li>
<li>Pass all tests (<code>npm test</code>)</li>
<li>Build successfully (<code>npm run build</code>)</li>
<li>Have a clear, descriptive commit message</li>
</ul>
<p>Example workflow:</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Make a small change</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span>                  <span class="token comment"># Verify tests pass</span>
<span class="token function">npm</span> run build            <span class="token comment"># Verify build works</span>
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"Add duration field to RSS feed template"</span>

<span class="token comment"># Make next change</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span>
<span class="token function">npm</span> run build
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"Update enclosure metadata script to include duration"</span></code></pre>
<h3 id="testing-strategy" tabindex="-1">Testing Strategy</h3>
<p>Run the test suite frequently:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token builtin class-name">test</span></code></pre>
<p>Tests verify:</p>
<ul>
<li>Build succeeds and generates expected files</li>
<li>Required pages are created (feed.xml, sitemap.xml)</li>
<li>Correct number of pages generated</li>
<li>All frontmatter fields are valid</li>
<li>No posts are missing required fields</li>
</ul>
<h3 id="common-tasks" tabindex="-1">Common Tasks</h3>
<p><strong>Start Development Server:</strong></p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run dev
<span class="token comment"># Site available at http://localhost:8080</span></code></pre>
<p><strong>Run Tests:</strong></p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token builtin class-name">test</span></code></pre>
<p><strong>Build Site:</strong></p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run build</code></pre>
<p><strong>Format Code:</strong></p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run <span class="token function">format</span></code></pre>
<p><strong>Clean Build:</strong></p>
<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run clean <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run build</code></pre>
<h2 id="scripts" tabindex="-1">Scripts</h2>
<p>Utility scripts are located in <code>scripts/</code> directory:</p>
<ul>
<li><code>update-enclosure-metadata.js</code>: Updates podcast enclosure metadata (length, type) from actual MP3 files</li>
<li><code>add-episode-numbers.js</code>: Adds episode numbers to posts missing them</li>
<li><code>add-slug-to-frontmatter.js</code>: Generates URL slugs from titles</li>
<li>Various other maintenance scripts</li>
</ul>
<h3 id="running-scripts" tabindex="-1">Running Scripts</h3>
<p>Scripts can be run directly:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">node</span> scripts/update-enclosure-metadata.js</code></pre>
<p>Always test and build after running scripts:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">node</span> scripts/some-script.js
<span class="token function">npm</span> <span class="token builtin class-name">test</span>
<span class="token function">npm</span> run build</code></pre>
<h2 id="recent-work-%26-learnings" tabindex="-1">Recent Work &amp; Learnings</h2>
<h3 id="podcast-feed-enclosure-metadata-(2025-10-25)" tabindex="-1">Podcast Feed Enclosure Metadata (2025-10-25)</h3>
<p><strong>Problem:</strong> The RSS feed's <code>&lt;enclosure&gt;</code> tags were missing or had incorrect metadata:</p>
<ul>
<li>99 posts had <code>length: null</code> and <code>type: null</code></li>
<li>68 posts had placeholder values like <code>length: 221</code></li>
<li>Only 4 posts had correct metadata</li>
</ul>
<p><strong>Solution:</strong> Created <code>scripts/update-enclosure-metadata.js</code> to:</p>
<ol>
<li>Read all blog post markdown files</li>
<li>Extract MP3 filename from S3 URL</li>
<li>Get actual file size from local MP3 files in <code>~/Sites/twistoflemonpod-mp3s/episodes/</code></li>
<li>Update frontmatter with correct values</li>
<li>Write back to files</li>
</ol>
<p><strong>Result:</strong> All 172 posts now have:</p>
<ul>
<li>Accurate <code>length</code> in bytes</li>
<li>Correct <code>type: audio/mpeg</code></li>
<li>Podcast feed fully compliant with Apple Podcasts, Spotify requirements</li>
</ul>
<p><strong>Key Learning:</strong> Podcast aggregators require the <code>length</code> attribute in enclosure tags. Missing it causes episodes to not appear or malfunction in podcast apps.</p>
<h3 id="migration-from-gatsby-(2025-10)" tabindex="-1">Migration from Gatsby (2025-10)</h3>
<p>Successfully migrated from Gatsby to Eleventy for:</p>
<ul>
<li>Faster build times (from minutes to &lt;0.5 seconds)</li>
<li>Simpler architecture and easier maintenance</li>
<li>Better developer experience</li>
<li>Maintained all functionality including audio players, feeds, and SEO</li>
</ul>
<h2 id="rss-feed-%26-podcast-compatibility" tabindex="-1">RSS Feed &amp; Podcast Compatibility</h2>
<p>The RSS feed (<code>/feed.xml</code>) is generated from <code>src/feed.liquid</code> and includes:</p>
<ul>
<li>Standard RSS 2.0 structure</li>
<li>iTunes podcast namespace</li>
<li>Proper <code>&lt;enclosure&gt;</code> tags with URL, length, and MIME type</li>
<li>iTunes-specific fields (duration, categories, etc.)</li>
<li>Full episode descriptions</li>
</ul>
<p>The feed is podcast-compatible and can be submitted to:</p>
<ul>
<li>Apple Podcasts</li>
<li>Spotify</li>
<li>Google Podcasts</li>
<li>Other podcast directories</li>
</ul>
<h2 id="maintenance" tabindex="-1">Maintenance</h2>
<h3 id="keeping-this-file-updated" tabindex="-1">Keeping This File Updated</h3>
<p><strong>IMPORTANT:</strong> As you work on this project, update this <a href="http://CLAUDE.md">CLAUDE.md</a> file with:</p>
<ol>
<li><strong>New learnings</strong>: Document solutions to problems encountered</li>
<li><strong>Architecture changes</strong>: Update if project structure changes</li>
<li><strong>New scripts</strong>: Document any new utility scripts added</li>
<li><strong>Dependencies</strong>: Note new packages or version upgrades</li>
<li><strong>Best practices</strong>: Add any new patterns or approaches discovered</li>
</ol>
<p>Also keep <code>README.md</code> updated with user-facing changes like:</p>
<ul>
<li>New features</li>
<li>Updated installation steps</li>
<li>Performance improvements</li>
<li>Breaking changes</li>
</ul>
<h3 id="documentation-philosophy" tabindex="-1">Documentation Philosophy</h3>
<ul>
<li><strong><a href="http://CLAUDE.md">CLAUDE.md</a></strong>: Developer-focused, comprehensive technical guide</li>
<li><strong><a href="http://README.md">README.md</a></strong>: User-focused, quick start guide for running the site</li>
<li>Keep them in sync but avoid duplication</li>
<li><a href="http://CLAUDE.md">CLAUDE.md</a> is the source of truth for development workflows</li>
</ul>
<h2 id="deployment" tabindex="-1">Deployment</h2>
<p>The site is static and can be deployed to any static hosting:</p>
<p><strong>GitHub Pages:</strong></p>
<ul>
<li>Build command: <code>npm run build</code></li>
<li>Publish directory: <code>_site</code></li>
<li>Branch: Configure in GitHub Pages settings</li>
</ul>
<p><strong>Other Hosts:</strong></p>
<ul>
<li>Netlify, Vercel, Cloudflare Pages all supported</li>
<li>Same build command and output directory</li>
</ul>
<h2 id="audio-files" tabindex="-1">Audio Files</h2>
<p>Audio files are hosted on AWS S3:</p>
<ul>
<li>Bucket: <code>twistoflemonpod</code></li>
<li>Region: <code>us-east-2</code></li>
<li>Path: <code>episodes/NNN-lwatol-YYYYMMDD.mp3</code></li>
</ul>
<p>Local copies are maintained in: <code>~/Sites/twistoflemonpod-mp3s/episodes/</code></p>
<h2 id="troubleshooting" tabindex="-1">Troubleshooting</h2>
<h3 id="build-fails" tabindex="-1">Build Fails</h3>
<ol>
<li>Check <code>npm test</code> for validation errors</li>
<li>Verify all post frontmatter is valid YAML</li>
<li>Ensure all required fields are present</li>
<li>Check for syntax errors in templates</li>
</ol>
<h3 id="feed-not-valid" tabindex="-1">Feed Not Valid</h3>
<ol>
<li>Verify all enclosure URLs are accessible</li>
<li>Ensure <code>length</code> values are accurate file sizes in bytes</li>
<li>Confirm <code>type</code> is set to <code>audio/mpeg</code> for MP3 files</li>
<li>Test with <a href="https://podbase.org/validate">Podbase Validator</a></li>
</ol>
<h3 id="missing-pages" tabindex="-1">Missing Pages</h3>
<ol>
<li>Check <code>.eleventy.js</code> configuration</li>
<li>Verify passthrough copy settings</li>
<li>Ensure pagination is configured correctly</li>
<li>Run <code>npm run clean &amp;&amp; npm run build</code></li>
</ol>
<h2 id="git-workflow" tabindex="-1">Git Workflow</h2>
<p>Always work on feature branches:</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Create feature branch</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-b</span> feature/description

<span class="token comment"># Make small changes with tests/build between commits</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span> <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run build
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"Descriptive message"</span>

<span class="token comment"># Continue iterating</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span> <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run build
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"Next change"</span>

<span class="token comment"># Push when ready</span>
<span class="token function">git</span> push origin feature/description</code></pre>
<p>Create pull requests for review before merging to main branches.</p>
<h2 id="performance-metrics" tabindex="-1">Performance Metrics</h2>
<p>Current performance (as of 2025-10-25):</p>
<ul>
<li>Build time: ~0.4 seconds</li>
<li>Total pages: 283</li>
<li>Total posts: 172</li>
<li>Categories: 15</li>
<li>Tags: 88</li>
<li>Average build per page: ~1.4ms</li>
</ul>
<h2 id="resources" tabindex="-1">Resources</h2>
<ul>
<li><a href="https://www.11ty.dev/docs/">11ty Documentation</a></li>
<li><a href="https://liquidjs.com/">Liquid Templating</a></li>
<li><a href="https://www.rssboard.org/rss-specification">RSS 2.0 Specification</a></li>
<li><a href="https://podcasters.apple.com/support/823-podcast-requirements">iTunes Podcast RSS</a></li>
<li><a href="https://plyr.io/">Plyr Audio Player</a></li>
</ul>
<h2 id="license" tabindex="-1">License</h2>
<p>Content © Jon Kohlmeier &amp; Stan Lemon</p>
<h2 id="contributing" tabindex="-1">Contributing</h2>
<p>When contributing to this project:</p>
<ol>
<li>Follow the iterative workflow described above</li>
<li>Keep commits small and focused</li>
<li>Always test and build between commits</li>
<li>Update this <a href="http://CLAUDE.md">CLAUDE.md</a> with new learnings</li>
<li>Update <a href="http://README.md">README.md</a> if user-facing changes</li>
<li>Write clear commit messages</li>
<li>Document any new scripts or utilities</li>
</ol>
<hr>
<p><strong>Last Updated:</strong> 2025-10-25
<strong>Version:</strong> 2.0.0 (Eleventy)</p>
