<h1 id="security-and-performance-headers-for-production" tabindex="-1">Security and Performance Headers for Production</h1>
<p>This document outlines recommended HTTP headers for the Life with a Twist of Lemon podcast website. These headers should be configured at the hosting/CDN level (GitHub Pages, Netlify, Cloudflare, etc.).</p>
<h2 id="security-headers" tabindex="-1">Security Headers</h2>
<h3 id="content-security-policy-(csp)" tabindex="-1">Content Security Policy (CSP)</h3>
<p>Prevents XSS attacks and unauthorized resource loading.</p>
<pre><code>Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; media-src 'self' https://media.twistoflemonpod.com; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'
</code></pre>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>default-src 'self'</code> - Only allow resources from same origin</li>
<li><code>script-src 'self' 'unsafe-inline'</code> - Allow inline scripts (needed for Plyr player)</li>
<li><code>media-src https://media.twistoflemonpod.com</code> - Allow audio from S3 bucket</li>
<li><code>frame-ancestors 'none'</code> - Prevent clickjacking</li>
</ul>
<h3 id="x-content-type-options" tabindex="-1">X-Content-Type-Options</h3>
<p>Prevents MIME type sniffing.</p>
<pre><code>X-Content-Type-Options: nosniff
</code></pre>
<h3 id="x-frame-options" tabindex="-1">X-Frame-Options</h3>
<p>Prevents clickjacking attacks.</p>
<pre><code>X-Frame-Options: DENY
</code></pre>
<h3 id="x-xss-protection" tabindex="-1">X-XSS-Protection</h3>
<p>Enables browser XSS protection.</p>
<pre><code>X-XSS-Protection: 1; mode=block
</code></pre>
<h3 id="referrer-policy" tabindex="-1">Referrer-Policy</h3>
<p>Controls referrer information sent with requests.</p>
<pre><code>Referrer-Policy: strict-origin-when-cross-origin
</code></pre>
<h3 id="permissions-policy" tabindex="-1">Permissions-Policy</h3>
<p>Controls browser features and APIs.</p>
<pre><code>Permissions-Policy: geolocation=(), microphone=(), camera=(), payment=()
</code></pre>
<h2 id="performance-headers" tabindex="-1">Performance Headers</h2>
<h3 id="cache-control" tabindex="-1">Cache-Control</h3>
<p>Optimize caching for static assets.</p>
<p><strong>For HTML files:</strong></p>
<pre><code>Cache-Control: public, max-age=0, must-revalidate
</code></pre>
<p><strong>For CSS/JS files:</strong></p>
<pre><code>Cache-Control: public, max-age=31536000, immutable
</code></pre>
<p><strong>For images:</strong></p>
<pre><code>Cache-Control: public, max-age=31536000, immutable
</code></pre>
<p><strong>For audio files (on S3):</strong></p>
<pre><code>Cache-Control: public, max-age=31536000
</code></pre>
<h3 id="compression" tabindex="-1">Compression</h3>
<p>Enable compression for text-based resources.</p>
<pre><code>Content-Encoding: gzip
</code></pre>
<p>or</p>
<pre><code>Content-Encoding: br
</code></pre>
<h2 id="implementation-by-platform" tabindex="-1">Implementation by Platform</h2>
<h3 id="github-pages" tabindex="-1">GitHub Pages</h3>
<p>GitHub Pages automatically sets some security headers but doesn't allow custom configuration. Consider using Cloudflare in front of GitHub Pages for full header control.</p>
<h3 id="netlify" tabindex="-1">Netlify</h3>
<p>Create a <code>_headers</code> file in your build output (<code>_site/_headers</code>):</p>
<pre><code>/*
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  X-XSS-Protection: 1; mode=block
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: geolocation=(), microphone=(), camera=(), payment=()
  Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; media-src 'self' https://media.twistoflemonpod.com; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'

/*.html
  Cache-Control: public, max-age=0, must-revalidate

/*.css
  Cache-Control: public, max-age=31536000, immutable

/*.js
  Cache-Control: public, max-age=31536000, immutable

/*.png
  Cache-Control: public, max-age=31536000, immutable

/*.jpg
  Cache-Control: public, max-age=31536000, immutable

/*.ico
  Cache-Control: public, max-age=31536000, immutable
</code></pre>
<p>To enable this, add to <code>.eleventy.js</code>:</p>
<pre class="language-javascript"><code class="language-javascript">eleventyConfig<span class="token punctuation">.</span><span class="token function">addPassthroughCopy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string-property property">"static/_headers"</span><span class="token operator">:</span> <span class="token string">"_headers"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And create <code>static/_headers</code> with the content above.</p>
<h3 id="cloudflare" tabindex="-1">Cloudflare</h3>
<p>Configure Page Rules or use Cloudflare Workers to set custom headers:</p>
<ol>
<li>Go to Cloudflare Dashboard</li>
<li>Select your domain</li>
<li>Navigate to Rules &gt; Transform Rules &gt; Modify Response Header</li>
<li>Add rules for each header listed above</li>
</ol>
<h3 id="vercel" tabindex="-1">Vercel</h3>
<p>Create a <code>vercel.json</code> file:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"/(.*)"</span><span class="token punctuation">,</span>
      <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"X-Frame-Options"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"DENY"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"X-Content-Type-Options"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"nosniff"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"X-XSS-Protection"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"1; mode=block"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Referrer-Policy"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"strict-origin-when-cross-origin"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Permissions-Policy"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"geolocation=(), microphone=(), camera=(), payment=()"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Content-Security-Policy"</span><span class="token punctuation">,</span>
          <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; media-src 'self' https://media.twistoflemonpod.com; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="testing-headers" tabindex="-1">Testing Headers</h2>
<p>Use these tools to verify headers are properly configured:</p>
<ol>
<li><strong>Security Headers</strong>: <a href="https://securityheaders.com/">https://securityheaders.com/</a></li>
<li><strong>Mozilla Observatory</strong>: <a href="https://observatory.mozilla.org/">https://observatory.mozilla.org/</a></li>
<li><strong>Browser DevTools</strong>: Network tab shows response headers</li>
<li><strong>curl</strong>: <code>curl -I https://twistoflemonpod.com</code></li>
</ol>
<h2 id="expected-scores" tabindex="-1">Expected Scores</h2>
<p>With all headers properly configured:</p>
<ul>
<li><strong>Security Headers</strong>: A+ rating</li>
<li><strong>Mozilla Observatory</strong>: A+ or A rating</li>
<li><strong>Lighthouse Performance</strong>: 90+ score</li>
</ul>
<h2 id="notes" tabindex="-1">Notes</h2>
<ul>
<li>The <code>'unsafe-inline'</code> directive in CSP is needed for the Plyr audio player</li>
<li>Consider using a CSP nonce or hash for inline scripts in production</li>
<li>Update <code>media-src</code> if audio hosting location changes</li>
<li>Review and update CSP directives if adding new third-party services</li>
<li>Test thoroughly after implementing to ensure nothing breaks</li>
</ul>
<h2 id="related-files" tabindex="-1">Related Files</h2>
<ul>
<li><code>robots.txt</code> - Search engine crawling rules</li>
<li><code>sitemap.xml</code> - Site structure for search engines</li>
<li><code>feed.xml</code> - RSS feed for podcast aggregators</li>
<li><code>src/_includes/partials/seo.liquid</code> - Meta tags for SEO</li>
</ul>
<h2 id="references" tabindex="-1">References</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">MDN Web Docs - HTTP Headers</a></li>
<li><a href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project</a></li>
<li><a href="https://content-security-policy.com/">Content Security Policy Reference</a></li>
</ul>
